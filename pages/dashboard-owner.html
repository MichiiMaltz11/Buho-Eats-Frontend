<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Owner Dashboard - Buho Eats</title>

    <!-- Tailwind CSS -->
    <script src="../libs/tailwind.js"></script>

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3D405B',
                        secondary: '#588B8B',
                        accent: '#F2CC8F',
                        dark: '#1A1A1D'
                    }
                }
            }
        }
    </script>

    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/reset.css">
</head>

<body class="bg-gray-100" data-page="dashboard-owner">

    <!-- NAV SUPERIOR -->
    <header class="bg-primary text-white py-4 px-6 flex justify-between items-center shadow-lg">
        <h1 class="text-xl font-semibold tracking-wide">Buho Eats - Panel del Dueño</h1>

        <div class="flex items-center gap-3">
            <span id="ownerName" class="font-medium"></span>
            <button onclick="logout()" class="bg-secondary px-3 py-2 rounded-lg hover:bg-opacity-80">
                Cerrar sesión
            </button>
        </div>
    </header>

    <!-- CONTENIDO -->
    <main class="max-w-5xl mx-auto mt-10 px-4">

        <h2 class="text-2xl font-bold text-primary mb-6">Bienvenido, Propietario</h2>

        <!-- CARD DE RESTAURANTE -->
        <div id="restaurantCard" class="bg-white shadow-lg rounded-xl p-6 border border-gray-200">
            <p class="text-gray-600">Cargando información de tu restaurante...</p>
        </div>

        <!-- BOTONES -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">

            <a href="owner-edit-restaurant.html"
                class="bg-secondary text-white py-4 text-center rounded-lg shadow hover:bg-opacity-90 transition">
                Editar Restaurante
            </a>

            <a href="owner-menu.html"
                class="bg-primary text-white py-4 text-center rounded-lg shadow hover:bg-opacity-90 transition">
                Gestionar Menú
            </a>

            <a href="owner-stats.html"
                class="bg-accent text-dark py-4 text-center rounded-lg shadow hover:bg-opacity-90 transition">
                Ver Estadísticas
            </a>

        </div>
    </main>

    <!-- Scripts del proyecto -->
    <script src="../assets/js/config.js"></script>
    <script src="../assets/js/utils.js"></script>
    <script src="../assets/js/api.js"></script>
    <script src="../assets/js/auth.js"></script>
    <script src="../assets/js/owner.js"></script>

    <script>
        // ⭐ PROTEGER LA PÁGINA SOLO PARA OWNERS
        if (!Auth.requireRole("owner")) {
            console.warn("Acceso denegado");
        }

        // Mostrar nombre del dueño
        const user = Auth.getUser();
        if (user) {
            document.getElementById("ownerName").textContent = user.firstName || user.first_name;
        }

        // Cargar restaurante al entrar
        async function loadRestaurant() {
            const card = document.getElementById("restaurantCard");

            const restaurant = await Owner.getMyRestaurant();
            if (!restaurant) {
                card.innerHTML = `
                    <p class="text-red-500 font-medium">
                        No tienes un restaurante creado aún.
                    </p>
                `;
                return;
            }

            card.innerHTML = `
                <h3 class="text-xl font-bold text-primary mb-4">${restaurant.name}</h3>

                <p><strong>Dirección:</strong> ${restaurant.address || 'No registrada'}</p>
                <p><strong>Teléfono:</strong> ${restaurant.phone || 'No registrado'}</p>

                <div class="mt-4">
                    <strong>Imagen:</strong><br>
                    ${
                        restaurant.image_url
                        ? `<img src="${restaurant.image_url}" class="w-48 rounded-lg shadow mt-2">`
                        : `<span class="text-gray-500">Sin imagen</span>`
                    }
                </div>
            `;
        }

        loadRestaurant();

        // Cerrar sesión
        function logout() {
            Auth.logout();
        }
    </script>

</body>
</html>